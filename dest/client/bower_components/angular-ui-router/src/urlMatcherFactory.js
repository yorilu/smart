function UrlMatcher(e,t,n){function h(t,n,r,i){c.push(t);if(f[t])return f[t];if(!/^\w+(-+\w+)*(?:\[\])?$/.test(t))throw new Error("Invalid parameter name '"+t+"' in pattern '"+e+"'");if(l[t])throw new Error("Duplicate parameter name '"+t+"' in pattern '"+e+"'");return l[t]=new $$UMFP.Param(t,n,r,i),l[t]}function p(e,t,n){var r=["",""],i=e.replace(/[\\\[\]\^$*+?.()|{}]/g,"\\$&");if(!t)return i;switch(n){case!1:r=["(",")"];break;case!0:r=["?(",")?"];break;default:r=["("+n+"|",")?"]}return i+r[0]+t+r[1]}function d(n,r){var i,s,u,a,f,l;return i=n[2]||n[3],f=t.params[i],u=e.substring(o,n.index),s=r?n[4]:n[4]||(n[1]=="*"?".*":null),a=$$UMFP.type(s||"string")||inherit($$UMFP.type("string"),{pattern:new RegExp(s)}),{id:i,regexp:s,segment:u,type:a,cfg:f}}t=extend({params:{}},isObject(t)?t:{});var r=/([:*])([\w\[\]]+)|\{([\w\[\]]+)(?:\:((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,i=/([:]?)([\w\[\]-]+)|\{([\w\[\]-]+)(?:\:((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,s="^",o=0,u,a=this.segments=[],f=n?n.params:{},l=this.params=n?n.params.$$new():new $$UMFP.ParamSet,c=[];this.source=e;var v,m,g;while(u=r.exec(e)){v=d(u,!1);if(v.segment.indexOf("?")>=0)break;m=h(v.id,v.type,v.cfg,"path"),s+=p(v.segment,m.type.pattern.source,m.squash),a.push(v.segment),o=r.lastIndex}g=e.substring(o);var y=g.indexOf("?");if(y>=0){var b=this.sourceSearch=g.substring(y);g=g.substring(0,y),this.sourcePath=e.substring(0,o+y);if(b.length>0){o=0;while(u=i.exec(b))v=d(u,!0),m=h(v.id,v.type,v.cfg,"search"),o=r.lastIndex}}else this.sourcePath=e,this.sourceSearch="";s+=p(g)+(t.strict===!1?"/?":"")+"$",a.push(g),this.regexp=new RegExp(s,t.caseInsensitive?"i":undefined),this.prefix=a[0],this.$$paramNames=c}function Type(e){extend(this,e)}function $UrlMatcherFactory(){function r(e){return e!=null?e.toString().replace(/\//g,"%2F"):e}function i(e){return e!=null?e.toString().replace(/%2F/g,"/"):e}function s(e){return this.pattern.test(e)}function c(){return{strict:t,caseInsensitive:e}}function h(e){return isFunction(e)||isArray(e)&&isFunction(e[e.length-1])}function p(){while(a.length){var e=a.shift();if(e.pattern)throw new Error("You cannot override a type's .pattern at runtime.");angular.extend(o[e.name],f.invoke(e.def))}}function d(e){extend(this,e||{})}$$UMFP=this;var e=!1,t=!0,n=!1,o={},u=!0,a=[],f,l={string:{encode:r,decode:i,is:s,pattern:/[^/]*/},"int":{encode:r,decode:function(e){return parseInt(e,10)},is:function(e){return isDefined(e)&&this.decode(e.toString())===e},pattern:/\d+/},bool:{encode:function(e){return e?1:0},decode:function(e){return parseInt(e,10)!==0},is:function(e){return e===!0||e===!1},pattern:/0|1/},date:{encode:function(e){return this.is(e)?[e.getFullYear(),("0"+(e.getMonth()+1)).slice(-2),("0"+e.getDate()).slice(-2)].join("-"):undefined},decode:function(e){if(this.is(e))return e;var t=this.capture.exec(e);return t?new Date(t[1],t[2]-1,t[3]):undefined},is:function(e){return e instanceof Date&&!isNaN(e.valueOf())},equals:function(e,t){return this.is(e)&&this.is(t)&&e.toISOString()===t.toISOString()},pattern:/[0-9]{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[1-2][0-9]|3[0-1])/,capture:/([0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])/},json:{encode:angular.toJson,decode:angular.fromJson,is:angular.isObject,equals:angular.equals,pattern:/[^/]*/},any:{encode:angular.identity,decode:angular.identity,is:angular.identity,equals:angular.equals,pattern:/.*/}};$UrlMatcherFactory.$$getDefaultValue=function(e){if(!h(e.value))return e.value;if(!f)throw new Error("Injectable functions cannot be called at configuration time");return f.invoke(e.value)},this.caseInsensitive=function(t){return isDefined(t)&&(e=t),e},this.strictMode=function(e){return isDefined(e)&&(t=e),t},this.defaultSquashPolicy=function(e){if(!isDefined(e))return n;if(e!==!0&&e!==!1&&!isString(e))throw new Error("Invalid squash policy: "+e+". Valid policies: false, true, arbitrary-string");return n=e,e},this.compile=function(e,t){return new UrlMatcher(e,extend(c(),t))},this.isMatcher=function(e){if(!isObject(e))return!1;var t=!0;return forEach(UrlMatcher.prototype,function(n,r){isFunction(n)&&(t=t&&isDefined(e[r])&&isFunction(e[r]))}),t},this.type=function(e,t,n){if(!isDefined(t))return o[e];if(o.hasOwnProperty(e))throw new Error("A type named '"+e+"' has already been defined.");return o[e]=new Type(extend({name:e},t)),n&&(a.push({name:e,def:n}),u||p()),this},forEach(l,function(e,t){o[t]=new Type(extend({name:t},e))}),o=inherit(o,{}),this.$get=["$injector",function(e){return f=e,u=!1,p(),forEach(l,function(e,t){o[t]||(o[t]=new Type(e))}),this}],this.Param=function(t,r,i,s){function d(e){var t=isObject(e)?objectKeys(e):[],n=indexOf(t,"value")===-1&&indexOf(t,"type")===-1&&indexOf(t,"squash")===-1&&indexOf(t,"array")===-1;return n&&(e={value:e}),e.$$fn=h(e.value)?e.value:function(){return e.value},e}function v(e,n,r){if(e.type&&n)throw new Error("Param '"+t+"' has two type configurations.");return n?n:e.type?e.type instanceof Type?e.type:new Type(e.type):r==="config"?o.any:o.string}function m(){var e={array:s==="search"?"auto":!1},n=t.match(/\[\]$/)?{array:!0}:{};return extend(e,n,i).array}function g(e,t){var r=e.squash;if(!t||r===!1)return!1;if(!isDefined(r)||r==null)return n;if(r===!0||isString(r))return r;throw new Error("Invalid squash policy: '"+r+"'. Valid policies: false, true, or arbitrary string")}function y(e,t,n,r){var i,s,o=[{from:"",to:n||t?undefined:""},{from:null,to:n||t?undefined:""}];return i=isArray(e.replace)?e.replace:[],isString(r)&&i.push({from:r,to:undefined}),s=map(i,function(e){return e.from}),filter(o,function(e){return indexOf(s,e.from)===-1}).concat(i)}function b(){if(!f)throw new Error("Injectable functions cannot be called at configuration time");return f.invoke(i.$$fn)}function w(e){function t(e){return function(t){return t.from===e}}function n(e){var n=map(filter(u.replace,t(e)),function(e){return e.to});return n.length?n[0]:e}return e=n(e),isDefined(e)?u.type.decode(e):b()}function E(){return"{Param:"+t+" "+r+" squash: '"+c+"' optional: "+l+"}"}var u=this;i=d(i),r=v(i,r,s);var a=m();r=a?r.$asArray(a,s==="search"):r,r.name==="string"&&!a&&s==="path"&&i.value===undefined&&(i.value="");var l=i.value!==undefined,c=g(i,l),p=y(i,a,l,c);extend(this,{id:t,type:r,location:s,array:a,squash:c,replace:p,isOptional:l,value:w,dynamic:undefined,config:i,toString:E})},d.prototype={$$new:function(){return inherit(this,extend(new d,{$$parent:this}))},$$keys:function(){var e=[],t=[],n=this,r=objectKeys(d.prototype);while(n)t.push(n),n=n.$$parent;return t.reverse(),forEach(t,function(t){forEach(objectKeys(t),function(t){indexOf(e,t)===-1&&indexOf(r,t)===-1&&e.push(t)})}),e},$$values:function(e){var t={},n=this;return forEach(n.$$keys(),function(r){t[r]=n[r].value(e&&e[r])}),t},$$equals:function(e,t){var n=!0,r=this;return forEach(r.$$keys(),function(i){var s=e&&e[i],o=t&&t[i];r[i].type.equals(s,o)||(n=!1)}),n},$$validates:function(t){var n=!0,r,i,s,o=this;return forEach(this.$$keys(),function(e){s=o[e],i=t[e],r=!i&&s.isOptional,n=n&&(r||!!s.type.is(i))}),n},$$parent:undefined},this.ParamSet=d}var $$UMFP;UrlMatcher.prototype.concat=function(e,t){var n={caseInsensitive:$$UMFP.caseInsensitive(),strict:$$UMFP.strictMode(),squash:$$UMFP.defaultSquashPolicy()};return new UrlMatcher(this.sourcePath+e+this.sourceSearch,extend(n,t),this)},UrlMatcher.prototype.toString=function(){return this.source},UrlMatcher.prototype.exec=function(e,t){function c(e){function t(e){return e.split("").reverse().join("")}function n(e){return e.replace(/\\-/,"-")}var r=t(e).split(/-(?!\\)/),i=map(r,t);return map(i,n).reverse()}var n=this.regexp.exec(e);if(!n)return null;t=t||{};var r=this.parameters(),i=r.length,s=this.segments.length-1,o={},u,a,f,l;if(s!==n.length-1)throw new Error("Unbalanced capture group in route '"+this.source+"'");for(u=0;u<s;u++){l=r[u];var h=this.params[l],p=n[u+1];for(a=0;a<h.replace;a++)h.replace[a].from===p&&(p=h.replace[a].to);p&&h.array===!0&&(p=c(p)),o[l]=h.value(p)}for(;u<i;u++)l=r[u],o[l]=this.params[l].value(t[l]);return o},UrlMatcher.prototype.parameters=function(e){return isDefined(e)?this.params[e]||null:this.$$paramNames},UrlMatcher.prototype.validates=function(e){return this.params.$$validates(e)},UrlMatcher.prototype.format=function(e){function f(e){return encodeURIComponent(e).replace(/-/g,function(e){return"%5C%"+e.charCodeAt(0).toString(16).toUpperCase()})}e=e||{};var t=this.segments,n=this.parameters(),r=this.params;if(!this.validates(e))return null;var i,s=!1,o=t.length-1,u=n.length,a=t[0];for(i=0;i<u;i++){var l=i<o,c=n[i],h=r[c],p=h.value(e[c]),d=h.isOptional&&h.type.equals(h.value(),p),v=d?h.squash:!1,m=h.type.encode(p);if(l){var g=t[i+1];if(v===!1)m!=null&&(isArray(m)?a+=map(m,f).join("-"):a+=encodeURIComponent(m)),a+=g;else if(v===!0){var y=a.match(/\/$/)?/\/?(.*)/:/(.*)/;a+=g.match(y)[1]}else isString(v)&&(a+=v+g)}else{if(m==null||d&&v!==!1)continue;isArray(m)||(m=[m]),m=map(m,encodeURIComponent).join("&"+c+"="),a+=(s?"&":"?")+(c+"="+m),s=!0}}return a},Type.prototype.is=function(e,t){return!0},Type.prototype.encode=function(e,t){return e},Type.prototype.decode=function(e,t){return e},Type.prototype.equals=function(e,t){return e==t},Type.prototype.$subPattern=function(){var e=this.pattern.toString();return e.substr(1,e.length-2)},Type.prototype.pattern=/.*/,Type.prototype.toString=function(){return"{Type:"+this.name+"}"},Type.prototype.$asArray=function(e,t){function n(e,t){function n(e,t){return function(){return e[t].apply(e,arguments)}}function r(e){return isArray(e)?e:isDefined(e)?[e]:[]}function i(e){switch(e.length){case 0:return undefined;case 1:return t==="auto"?e[0]:e;default:return e}}function s(e){return!e}function o(e,t){return function(o){o=r(o);var u=map(o,e);return t===!0?filter(u,s).length===0:i(u)}}function u(e){return function(n,i){var s=r(n),o=r(i);if(s.length!==o.length)return!1;for(var u=0;u<s.length;u++)if(!e(s[u],o[u]))return!1;return!0}}this.encode=o(n(e,"encode")),this.decode=o(n(e,"decode")),this.is=o(n(e,"is"),!0),this.equals=u(n(e,"equals")),this.pattern=e.pattern,this.$arrayMode=t}if(!e)return this;if(e==="auto"&&!t)throw new Error("'auto' array mode is for query parameters only");return new n(this,e)},angular.module("ui.router.util").provider("$urlMatcherFactory",$UrlMatcherFactory),angular.module("ui.router.util").run(["$urlMatcherFactory",function(e){}])