var _=require("lodash"),path=require("canonical-path"),log=require("winston"),outputFolder,processorConfig,currentVersion;module.exports={name:"pages-data",description:"This plugin will create a new doc that will be rendered as an angularjs module which will contain meta information about the pages and navigation",runAfter:["adding-extra-docs","component-groups-generate"],runBefore:["extra-docs-added"],init:function(e){outputFolder=e.rendering.outputFolder,processorConfig=e.get("processing.pages-data",{}),currentVersion=e.get("currentVersion")},process:function(e){var t=_(e).filter(function(e){return e.area==="api"}).filter(function(e){return e.module==="ionic"}).filter(function(e){return e.docType!=="componentGroup"}).groupBy(function(e){return e.group||(e.group="Other"),e.group}).map(function(e,t){var n=_(e).groupBy("docType").map(function(e,t){return{name:t,pages:_(e).sortBy(function(e){return e.groupMainItem}).map(function(e){return{href:e.path,name:e.name,docType:e.docType,type:e.docType}}).filter(function(e){return!!e.name}).value()}}).sortBy(function(e){return e.name!="directive"}).value();return{name:t,sections:n}}).sortBy(function(e){return _.values(e.sections).length}).value();_.forEach(e,function(e){e.path||log.warn("Missing path property for ",e.id)});var n={docType:"pages-data",id:"pages-data",template:processorConfig.template||"pages-data.template.js",outputPath:processorConfig.outputPath||"js/pages-data.js",groups:t};e.push(n)}}