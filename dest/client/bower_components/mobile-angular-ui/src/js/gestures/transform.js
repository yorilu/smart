(function(){angular.module("mobile-angular-ui.gestures.transform",[]).factory("Transform",["$window",function(e){function t(e){return e.length}function n(e){return e[0]?e[0].length:0}function r(e,r){var i=n(e),s=n(r),o=t(e),u=t(r);if(i!=u)throw new Error("error: incompatible sizes");var a=[];for(var f=0;f<o;f++){a[f]=[];for(var l=0;l<s;l++){var c=0;for(var h=0;h<i;h++)c+=e[f][h]*r[h][l];a[f][l]=c}}return a}function c(e){this.mtx=e||[[1,0,0],[0,1,0],[0,0,1]]}var i,s,o,u=["","webkit","Moz","O","ms"],a=e.document.createElement("div");for(var f=0;f<u.length;f++){var l=u[f];if(l+"Perspective"in a.style){i=l===""?"":"-"+l.toLowerCase()+"-",o=l+(l===""?"transform":"Transform"),s=i+"transform";break}}return a=null,c.getElementTransformProperty=function(t){t=t.length?t[0]:t;var n=e.getComputedStyle(t,null).getPropertyValue(s);return n},c.setElementTransformProperty=function(e,t){e=e.length?e[0]:e,e.style[o]=t},c.fromElement=function(e){e=e.length?e[0]:e;var t=c.getElementTransformProperty(e);if(!t||t==="none")return new c;if(t.match("matrix3d"))throw new Error("Handling 3d transform is not supported yet");var n=t.split("(")[1].split(")")[0].split(",").map(Number),r=[[n[0],n[2],n[4]],[n[1],n[3],n[5]],[0,0,1]];return new c(r)},c.prototype.apply=function(e,t){e=e.length?e[0]:e;var n=c.fromElement(e).merge(this).mtx;return e.style[o]="matrix("+[n[0][0],n[1][0],n[0][1],n[1][1],n[0][2],n[1][2]].join(",")+")",this},c.prototype.set=function(e){e=e.length?e[0]:e;var t=this.mtx;return e.style[o]="matrix("+[t[0][0],t[1][0],t[0][1],t[1][1],t[0][2],t[1][2]].join(",")+")",this},c.prototype.rotate=function(e){e*=Math.PI/180;var t=[[Math.cos(e),-Math.sin(e),0],[Math.sin(e),Math.cos(e),0],[0,0,1]];return this.mtx=r(t,this.mtx),this},c.prototype.translate=function(e,t){t=t===null||t===undefined?e:t;var n=[[1,0,e],[0,1,t],[0,0,1]];return this.mtx=r(n,this.mtx),this},c.prototype.scale=function(e){var t=[[e,0,0],[0,e,0],[0,0,1]];return this.mtx=r(t,this.mtx),this},c.prototype.merge=function(e){return this.mtx=r(this.mtx,e.mtx),this},c.prototype.getRotation=function(){var e=this.mtx;return Math.round(Math.atan2(e[1][0],e[0][0])*(180/Math.PI))},c.prototype.getTranslation=function(){var e=this.mtx;return{x:e[0][2],y:e[1][2]}},c.prototype.getScale=function(){var e=this.mtx,t=e[0][0],n=e[1][0],r=10;return Math.round(Math.sqrt(t*t+n*n)*r)/r},c.prototype.matrixToString=function(){var e=this.mtx,t="";for(var n=0;n<e.length;n++){for(var r=0;r<e[n].length;r++){var i=""+e[n][r];t+=i;for(var s=0;s<5-i.length;s++)t+=" "}t+="\n"}return t},c}])})()