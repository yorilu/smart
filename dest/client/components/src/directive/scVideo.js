angular.module("smartCourtLib").directive("scVideoContainer",["scUtil","$document","$rootScope",function(e,t,n){return{restrict:"E",replace:!0,transclude:!0,scope:{playvideo:"="},template:"<div></div>",compile:function(t,n){var r,i,s=n.type?n.type:"default";if(s=="small"){var i='<div class="vedioimg" ng-click="play()" ng-show="showMask"><img ng-src="{{poster}}"/></div><div ng-show="showMask" ng-click="play()" class="playicon"></div><div ng-show="showMask" class="bgcol">{{title}}</div><div ng-transclude class="abtion tl"></div>';r="videomain width48"}else{var i='<div class="outimag" ng-click="play()" ng-show="showMask"><img ng-src="{{poster}}"/></div><div ng-show="showMask" ng-click="play()" class="vepagic"></div><div ng-show="showMask"><a href="javascript:" class="dwnapp">想看不同角度的视频，请下载安装 智慧运动场</a></div><div ng-transclude></div>';r="repst detail-main-video"}return t.html(i),t.addClass(r),function(t,n,r){var i=$(n[0]),s=i.find("video"),o=s[0];t.showMainVideo=!0;var u=t.$watch(function(){return o.poster},function(e,n,r){e!=""&&/\.jpg|\.png/.test(e)&&(t.poster=e,u())});t.$watch(function(){return o.src},function(e,n,r){e!=n&&t.playvideo&&setTimeout(function(){o.play()},50)}),t.$watch(function(){return o.title},function(e,t,n){e&&(n.title=e)}),t.$watch(function(){return t.playvideo},function(e,t,n){e&&setTimeout(function(){o.play()},50)}),t.play=function(){t.playvideo=!0,o.play(),e.fullScreen(o),window.name=document.title,document.title=o.title},t.showMask=!0,s.on("play",function(){$(o).removeClass("videohide"),console.log(22),setTimeout(function(){t.showMask=!1,t.$apply()},500)}),s.on("pause ended",function(e){t.showMask=!0,t.playvideo=!1,$(o).addClass("videohide"),e.type=="ended"&&(document.title=window.name),t.$apply()})}}}}])